--- ../src-base/minecraft/net/minecraft/server/MinecraftServer.java
+++ ../src-work/minecraft/net/minecraft/server/MinecraftServer.java
@@ -1,5 +1,7 @@
 package net.minecraft.server;
 
+import carpet.helpers.ThrowableSuppression;
+import carpet.utils.Messenger;
 import com.google.common.collect.Lists;
 import com.google.common.collect.Queues;
 import com.google.common.util.concurrent.Futures;
@@ -86,6 +88,10 @@
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 
+import carpet.CarpetServer;
+import carpet.CarpetSettings;
+import carpet.helpers.LagSpikeHelper;
+
 public abstract class MinecraftServer implements ICommandSender, Runnable, IThreadListener, ISnooperInfo
 {
     private static final Logger field_147145_h = LogManager.getLogger();
@@ -274,6 +280,7 @@
         this.field_71318_t.func_72364_a(this.field_71305_c);
         this.func_147139_a(this.func_147135_j());
         this.func_71222_d();
+        CarpetServer.loadBots(this);
     }
 
     protected void func_71222_d()
@@ -620,6 +627,7 @@
             this.field_147147_p.func_151318_b().func_151330_a(agameprofile);
         }
 
+        LagSpikeHelper.processLagSpikes(null, LagSpikeHelper.TickPhase.AUTOSAVE, LagSpikeHelper.PrePostSubPhase.PRE);
         if (this.field_71315_w % 900 == 0)
         {
             this.field_71304_b.func_76320_a("save");
@@ -627,6 +635,7 @@
             this.func_71267_a(true);
             this.field_71304_b.func_76319_b();
         }
+        LagSpikeHelper.processLagSpikes(null, LagSpikeHelper.TickPhase.AUTOSAVE, LagSpikeHelper.PrePostSubPhase.POST);
 
         this.field_71304_b.func_76320_a("tallying");
         this.field_71311_j[this.field_71315_w % 100] = System.nanoTime() - i;
@@ -649,8 +658,10 @@
 
     public void func_71190_q()
     {
+        LagSpikeHelper.processLagSpikes(null, LagSpikeHelper.TickPhase.TICK, LagSpikeHelper.PrePostSubPhase.PRE);
         this.field_71304_b.func_76320_a("jobs");
 
+        LagSpikeHelper.processLagSpikes(null, LagSpikeHelper.TickPhase.PLAYER, LagSpikeHelper.PrePostSubPhase.PRE);
         synchronized (this.field_175589_i)
         {
             while (!this.field_175589_i.isEmpty())
@@ -658,6 +669,7 @@
                 Util.func_181617_a(this.field_175589_i.poll(), field_147145_h);
             }
         }
+        LagSpikeHelper.processLagSpikes(null, LagSpikeHelper.TickPhase.PLAYER, LagSpikeHelper.PrePostSubPhase.POST);
 
         this.field_71304_b.func_76318_c("levels");
 
@@ -672,6 +684,7 @@
                 {
                     return worldserver.func_72912_H().func_76065_j();
                 });
+                LagSpikeHelper.processLagSpikes(null, LagSpikeHelper.TickPhase.DIMENSION, LagSpikeHelper.PrePostSubPhase.PRE);
 
                 if (this.field_71315_w % 20 == 0)
                 {
@@ -707,6 +720,7 @@
                 this.field_71304_b.func_76319_b();
                 this.field_71304_b.func_76320_a("tracker");
                 worldserver.func_73039_n().func_72788_a();
+                LagSpikeHelper.processLagSpikes(null, LagSpikeHelper.TickPhase.DIMENSION, LagSpikeHelper.PrePostSubPhase.POST);
                 this.field_71304_b.func_76319_b();
                 this.field_71304_b.func_76319_b();
             }
